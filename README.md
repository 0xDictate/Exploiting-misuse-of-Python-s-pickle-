# Exploiting-misuse-of-Python-s-pickle-
class VulnerableProtocol(protocol.Protocol):   def dataReceived(self, data):       # Code to actually parse incoming data according to an      #  internal state machine      # If we just finished receiving headers, call verifyAuth() to        check authentication    def verifyAuth(self, headers):     try:       token = cPickle.loads(base64.b64decode(headers['AuthToken']))       if not check_hmac(token['signature'], token['data'], getSecretKey()):         raise AuthenticationFailed       self.secure_data = token['data']     except:       raise AuthenticationFailed
